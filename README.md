# Часовой
Набор инструментов для работы с API Школы 21. Работает в браузере, не требует установки и компиляции.

Требует запуск локального сервера и наличие логина и пароля на Платформе Школы 21 для доступа к API.

Все скрипты настроены для работы с API на момент публикации https://platform.21-school.ru/docs

**Часовой состоит из модулей:**
- Главная
- Кампус
- Пиры
- Дерево
- Апишка

## Главная
<img width="1154" height="1055" alt="preview-index" src="https://github.com/user-attachments/assets/16668aaf-6222-45e7-93cd-0a34245dd572" />

На главной странице происходит ввод данных для авторизации и проверка статуса локального сервера.

Модуль выбирается из списка вверху страницы.

## Кампус
<img width="1024" height="875" alt="preview-campus" src="https://github.com/user-attachments/assets/b89cf824-7348-4261-83f7-87e71c0a32a1" />

Выводятся карты кампусов для всех городов Школы.

Отображены статусы свободно/занято.

Для пиров в кампусе отображается всплывающий тултип с информацией пира.

Возможна подписка на друзей и получение уведомлений о логине/разлогинивании.

## Пиры
<img width="1024" height="875" alt="preview-peers" src="https://github.com/user-attachments/assets/d2761f00-f7c1-401d-a5c6-860604ed2ab5" />

Список друзей и пиров с подробными карточками данных по XP, PRP, уровню и актуальный список проектов.

Возможно включение автообновления статусов.

## Дерево
<img width="1024" height="875" alt="preview-graph" src="https://github.com/user-attachments/assets/de3739c3-9098-411b-902c-c98549308e3d" />

Развернутое дерево всех веток Школы. 

Возможность фильтровать по веткам, искать проекты и видеть требования для начала проекта.

Возможно включение автообновления статусов.

## Апишка
<img width="1024" height="875" alt="preview-api" src="https://github.com/user-attachments/assets/79e21e50-6243-44f0-85e1-5fcc7c4ad84c" />

Редактор запросов API. Параметры кэшируются заранее и отображаются в выпадающих списках. Есть возможность добавлять избранные параметры "в память".

Отображается структура ответа от API в виде кода.

## Работа с паролями

Без ввода пароля невозможна работа с API Школы.

**Хранить пароль в браузере**
На главной странице http://localhost:8000/ можно ввести логины и пароли в форму и выбрать "Запомнить данные в браузере". Данные будут храниться в локальном хранилище браузера

**Не хранить пароль в браузере**
На главной странице http://localhost:8000/ можно ввести логины и пароли в форму и не сохранять данные в браузере. Будет создан куки с логином и паролем, который удаляется при завершении сессии.

## Уведомления в Телеграм (не обязательно)

Несколько скриптов позволяют получать уведомления в Телеграм.

Создать телеграм бота можно через @BotFather. Нужно получить токен бота.

Узнать свой ID в Телеграм можно через @userinfobot

## Запуск локального сервера

Для работы нужно запустить Питон-скрипт (он включит localhost и cors proxy).

**1. Проверить, установлен ли Питон**
```
python3 --version или python --version
```

**2. Установить Питон, если его нет:**

- Мак:
```
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
brew install python
```

- Убунту:
```
sudo apt update
sudo apt install python3
sudo apt install python3-pip
```

- Виндовс:
Скачать с сайта python.org или
```
wsl --install
```
Повторить команды для Линукс

**3. Зависимости**
Зависимости Питона перечислены в файле requirements.txt
```
requests>=2.28.0
urllib3>=1.26.0
```
Если возникают сообщения об отсутствии какой-то из библиотек:
```
pip install -r requirements.txt
```

**4. Запуск сервера**
Запустить сервер в директории со скриптом через
```
python3 start.py или python start.py
```

**5. Открыть в браузере:**
- Главная: http://localhost:8000/
- Кампус: http://localhost:8000/src/watchman-campus.html
- Пиры: http://localhost:8000/src/watchman-peers.html
- Дерево: http://localhost:8000/src/watchman-graph.html
- Апишка: http://localhost:8000/src/watchman-fullapi.html


**6. Для остановки Питон-скрипта:** **Ctrl + C**

## Настройка шаблонов карты кампуса

По умолчанию, все кластеры кампусов отображаются в том порядке, в котором их передает API. Но можно настроить отображение нужного кампуса в файле с шаблонами **src/maps.js**

Нужно найти id своего кампуса и добавить новый элемент в файл:

```
const CAMPUS_TEMPLATES = {
    '5a23bec9-f989-485d-935b-3f0dc61c4812': [
        …
        { type: 'cluster', name: 'Kulibin', align: 'right' },
    ],
    'another-campus-id': [
        { type: 'cluster', name: 'Neutron', align: 'left' },
        { type: 'building', name: 'Proton', align: 'right' }
    ]
};
```

## Дебаггинг

Для страниц Пиры и Кампус есть возможность запуска скрипта для дебаггинга HTML элементов. Нужно подключить скрипт в конце файла перед `</body>`

```
<script src="debug.js"></script>
```

При нажатии комбинации клавиш **Ctrl + Shift + D** происходят изменения на странице.

## Исполняемые файлы

Проект можно запускать в два клика.

В папке **/exe** лежат 3 исполняемых файла. Возможно, придется дать файлу права на исполнение (chmod +x watchman.***).

Исполняемый файл для своей платформы нужно переложить в директорию, в которой лежит файл start.py

- exe/watchman.bat - Windows
- exe/watchman.sh - Linux
- exe/watchman.command - Mac

## Важно

Проект существует только для образовательного/персонального использования. Используйте код на свой риск. Автор передает код как есть, и не несет обязательств.
